
Dans ce scÃ©nario, un rÃ©seau a Ã©tÃ© compromis et votre objectif est d'analyser le trafic rÃ©seau capturÃ© afin d'en extraire des informations clÃ©s sur l'attaque. Vous utiliserez des outils comme Wireshark pour examiner l'activitÃ© rÃ©seau et identifier les actions malveillantes, les systÃ¨mes affectÃ©s et les artefacts associÃ©s.  

Ce laboratoire met l'accent sur l'importance de l'analyse forensique des rÃ©seaux pour identifier les indicateurs de compromission et enquÃªter sur les incidents afin d'assurer une rÃ©ponse efficace.  

**Outils :**  
* Wireshark  

---

## Flags  

ğŸ´â€â˜ ï¸ Flag 1: What is the domain name(abcd.site) accessed by the infected user that returned a 200 OK response code?  
ğŸ´â€â˜ ï¸ Flag 2: What is the IP address, MAC address of the infected Windows client?  
ğŸ´â€â˜ ï¸ Flag 3: Which Wireshark filter can you use to determine the victimâ€™s hostname from NetBIOS   Name Service traffic, and what is the detected hostname for this malware infection?  
ğŸ´â€â˜ ï¸ Flag 4: Which user got infected and ran the mystery_file.ps1 PowerShell script?  
ğŸ´â€â˜ ï¸ Flag 5: What User-Agent string indicates the traffic generated by a PowerShell script?  
ğŸ´â€â˜ ï¸ Flag 6: Which wallet extension ID is associated with the Coinbase wallet?  

---

<details>
<summary><h3> :arrow_forward: **ğŸ´â€â˜ ï¸ Flag 1: What is the domain name(abcd.site) accessed by the infected user that returned a 200 OK response code?**<h3></summary>  

>:bulb: Je filtre sur le protocole HTTP, puis je vois une requÃªte rÃ©ussie (200), je la sÃ©lectionne et je vais dans la partie HTTP pour voir le site : **`623start.site`**  

![alt text](<../Images/Capture d'Ã©cran 2026-01-24 103411.png>)

</details>

---

<details>
<summary><h3> :arrow_forward:ğŸ´â€â˜ ï¸ Flag 2: What is the IP address, MAC address of the infected Windows client?<h3></summary>  

>:bulb: Dans les mÃªme trame on voit bien que le client est la destination, puisqu'il reÃ§oit le code 200 sur serveur.  
> Dans la partie couche 2 on voit donc son adresse MAC et dans la partie IP, son IP (adresse privÃ©e)  

![alt text](<../Images/Capture d'Ã©cran 2026-01-24 104624.png>)

</details>

---

<details>
<summary><h3> :arrow_forward:ğŸ´â€â˜ ï¸ Flag 3: Which Wireshark filter can you use to determine the victimâ€™s hostname from NetBIOS   Name Service traffic, and what is the detected hostname for this malware infection?<h3></summary> 

>:bulb: Il faut filtrer avec `nbns` (mais avec "smb" on peut aussi voir). Puis on voit facilement le hostname.  

![alt text](<../Images/Capture d'Ã©cran 2026-01-24 111341.png>)

</details>

---

<details>
<summary><h3> :arrow_forward:ğŸ´â€â˜ ï¸ Flag 4: Which user got infected and ran the mystery_file.ps1 PowerShell script?<h3></summary>

>:bulb: On filtre avec le protocole TCP contenant le nom du script powershell. On obtient 1 trame, on va dans le data pour voir le contenu.  

![alt text](<../Images/Capture d'Ã©cran 2026-01-24 115512.png>)

>:bulb: On peut aussi aller dans "Edit>Find Packet", puis mettre "Packet Bytes" et dans "Case Sensitive"->String, puis rechercher. On arrive sur le paquet prÃ©cis et il faut le cpier en texte imprimable ascii et on voit le user. 

>:bulb: Puis je copie dans le bloc-note Mousepad en format "printable"  

![alt text](<../Images/Capture d'Ã©cran 2026-01-24 120052.png>)

</details>


---

<details>
<summary><h3> :arrow_forward:ğŸ´â€â˜ ï¸ Flag 5: What User-Agent string indicates the traffic generated by a PowerShell script?<h3></summary>  

>:bulb: Dans les requÃªtes HTTP, on distingue en bas dans la partie HTTP, le User-Agent : Mozilla, puis PowerShell  


![alt text](<../Images/Capture d'Ã©cran 2026-01-24 121955.png>)

</details>

---


<details>
<summary><h3> :arrow_forward:ğŸ´â€â˜ ï¸ Flag 6: Which wallet extension ID is associated with the Coinbase wallet?<h3></summary>  

>:bulb: Celui ci pas Ã©vident. On doit chercher quelque part "Coinbase".  
>`CTRL+F`, mettre ``Packet Byte`` et `Coinbase` dans la recherche et `Find`. On arrive sur le paquet "1710". Puis clic droit `Follow>TCP Stream` et on arrive directement sur le "Coinbase" comme sur l'image.  


![alt text](<../Images/Capture d'Ã©cran 2026-01-24 151829.png>)


</details>

---
